<!DOCTYPE html>
<html data-ng-app="application">

<head>
    <meta charset="UTF-8">
    <title>apollo</title>
    <link rel="stylesheet" type="text/css" href="../../vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../vendor/angular/angular-toastr-1.4.1.min.css">
    <link rel="stylesheet" type="text/css" media='all' href="../../vendor/angular/loading-bar.min.css">
    <link rel="stylesheet" type="text/css" href="../../styles/common-style.css">
</head>

<body>

<div ng-include="'../common/nav.html'"></div>
    <div class="container-fluid">
        <div class="app" ng-controller="AppConfigController as appConfig">

            <!--配置信息-->
            <div id="config-info">

                <!--具体配置信息-->
                <div class="row config-info-container">
                    <!--tag导航-->
                    <div class="col-md-2">
                        <div id="treeview"></div>
                    </div>

                    <div class="col-md-10 config-item-container">

                        <div class="cluster-namespace J_cluster-namespace">
                            <div class="panel">
                                <header class="panel-heading">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <b>hermas</b>
                                                <span class="label label-info">有修改,可发布
                                                <span class="badge">4</span></span>
                                        </div>
                                        <div class="col-md-7">
                                            <div class="btn-toolbar" role="toolbar" aria-label="...">
                                                <div class="btn-group" role="group" aria-label="...">
                                                    <button type="button"
                                                            class="btn btn-primary btn-sm J_tableview_btn">发布
                                                    </button>
                                                    <button type="button"
                                                            class="btn btn-danger btn-sm J_tableview_btn">回滚
                                                    </button>
                                                    <button type="button"
                                                            class="btn btn-default btn-sm J_historyview_btn">
                                                        查看历史版本
                                                    </button>
                                                </div>
                                                <div class="btn-group" role="group" aria-label="...">
                                                    <div class="btn-group" role="group">
                                                        <button type="button"
                                                                class="btn btn-default btn-sm J_tableview_btn">授权
                                                        </button>
                                                        <button type="button"
                                                                class="btn btn-default btn-sm J_tableview_btn">克隆
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="btn-group" role="group" aria-label="...">
                                                    <button type="button"
                                                            class="btn btn-info btn-sm J_tableview_btn" disabled>
                                                        视图
                                                    </button>
                                                    <button type="button"
                                                            class="btn btn-default btn-sm J_tableview_btn">文本
                                                    </button>
                                                    <button type="button"
                                                            class="btn btn-default btn-sm J_tableview_btn">表格
                                                    </button>
                                                    <button type="button"
                                                            class="btn btn-default btn-sm J_historyview_btn">
                                                        更改日志
                                                    </button>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="col-md-2 text-right">
                                            &nbsp;&nbsp;
                                            <a data-toggle="tooltip" data-placement="top" title="取消修改"
                                               ng-if="appConfig.space.isEditing" ng-click="cancelChanges()">
                                                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                            </a>
                                            &nbsp;
                                            <a data-toggle="tooltip" data-placement="top" title="修改配置"
                                               ng-if="!appConfig.space.isEditing" ng-click="appConfig.space.isEditing = true">
                                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                            </a>
                                            <a data-toggle="tooltip" data-placement="top" title="保存修改"
                                               ng-if="appConfig.space.isEditing"
                                               ng-disabled="!appConfig.space.hasChanges() || appConfig.space.tableTracker.$invalid"
                                               ng-click="appConfig.space.saveChanges()">
                                                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                                            </a>
                                            &nbsp;
                                            <a data-toggle="tooltip" data-placement="top" title="添加配置"
                                               ng-click="appConfig.space.add()" ng-if="appConfig.space.isEditing">
                                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                                            </a>
                                        </div>
                                    </div>
                                </header>

                                <!--配置列表-->
                                <div class="J_tableview">
                                    <table ng-table="appConfig.space.tableParams"
                                           class="table table-bordered text-center table-hover editable-table"
                                           ng-form="appConfig.space.tableForm" disable-filter="appConfig.space.isAdding"
                                           tracked-table="appConfig.space.tableTracker">
                                        <colgroup>
                                            <col width="20%"/>
                                            <col width="25%"/>
                                            <col width="25%"/>
                                            <col width="10%"/>
                                            <col width="10%"/>
                                            <col width="10%"/>
                                        </colgroup>
                                        <tr ng-repeat="row in $data" ng-form="rowForm" tracked-table-row="row"
                                            ng-class="{danger:row.modified}">
                                            <td title="'Key'" filter="{key: 'text'}" sortable="'key'"
                                                ng-switch="appConfig.space.isEditing" ng-class="key.$dirty ? 'bg-warning' : ''"
                                                ng-form="key" tracked-table-cell>
                                                <span ng-switch-default class="editable-text">{{row.key}}</span>
                                                <div class="controls"
                                                     ng-class="key.$invalid && key.$dirty ? 'has-error' : ''"
                                                     ng-switch-when="true">
                                                    <input type="text" name="key" ng-model="row.key"
                                                           class="editable-input form-control input-sm" required/>
                                                </div>
                                            </td>
                                            <td title="'Value'" filter="{value: 'text'}" sortable="'value'"
                                                ng-switch="appConfig.space.isEditing"
                                                ng-class="value.$dirty ? 'bg-warning' : ''"
                                                ng-form="value" tracked-table-cell>
                                                <a data-toggle="tooltip" data-placement="top" title="查看旧值"
                                                   class="glyphicon glyphicon-eye-open" ng-show="row.modified"
                                                   aria-hidden="true"></a>
                                                <span ng-switch-default class="editable-text">{{row.value}}</span>
                                                <div class="controls"
                                                     ng-class="value.$invalid && value.$dirty ? 'has-error' : ''"
                                                     ng-switch-when="true">
                                                    <input type="text" name="value" ng-model="row.value"
                                                           class="editable-input form-control input-sm" required/>
                                                </div>
                                            </td>
                                            <td title="'备注'" filter="{comment: 'text'}" sortable="'comment'"
                                                ng-switch="appConfig.space.isEditing"
                                                ng-class="comment.$dirty ? 'bg-warning' : ''"
                                                ng-form="comment" tracked-table-cell>
                                                <span ng-switch-default class="editable-text">{{row.comment}}</span>
                                                <div class="controls"
                                                     ng-class="comment.$invalid && comment.$dirty ? 'has-error' : ''"
                                                     ng-switch-when="true">
                                                    <input type="text" name="comment" ng-model="row.comment"
                                                           class="editable-input form-control input-sm" required/>
                                                </div>
                                            </td>
                                            <td title="'最后修改者'"
                                                filter="{dataChangeLastModifiedBy: 'text'}"
                                                sortable="'dataChangeLastModifiedBy'"
                                                ng-switch="appConfig.space.isEditing"
                                                ng-class="dataChangeLastModifiedBy.$dirty ? 'bg-warning' : ''"
                                                ng-form="dataChangeLastModifiedBy" tracked-table-cell>
                                                <span ng-switch-default class="editable-text">{{row.dataChangeLastModifiedBy}}</span>
                                                <div class="controls"
                                                     ng-class="dataChangeLastModifiedBy.$invalid && dataChangeLastModifiedBy.$dirty ? 'has-error' : ''"
                                                     ng-switch-when="true">
                                                    <input type="text" name="dataChangeLastModifiedBy"
                                                           ng-model="row.dataChangeLastModifiedBy"
                                                           class="editable-input form-control input-sm" required/>
                                                </div>
                                            </td>
                                            <td title="'最后修改时间'"
                                                sortable="'value'"
                                                ng-switch="appConfig.space.isEditing"
                                                ng-class="dataChangeLastModifiedTime.$dirty ? 'bg-warning' : ''"
                                                ng-form="dataChangeLastModifiedTime" tracked-table-cell>
                                                <span ng-switch-default class="editable-text">{{row.dataChangeLastModifiedTime}}</span>
                                                <div class="controls"
                                                     ng-class="dataChangeLastModifiedTime.$invalid && dataChangeLastModifiedTime.$dirty ? 'has-error' : ''"
                                                     ng-switch-when="true">
                                                    <input type="text" name="dataChangeLastModifiedTime"
                                                           ng-model="row.dataChangeLastModifiedTime"
                                                           class="editable-input form-control input-sm" required/>
                                                </div>
                                            </td>
                                            <td ng-if="appConfig.space.isEditing" tracked-table-cell>
                                                <button class="btn btn-danger btn-sm" ng-click="appConfig.space.del(row)"
                                                        ng-disabled="!appConfig.space.isEditing"><span
                                                        class="glyphicon glyphicon-trash"></span></button>
                                            </td>
                                        </tr>
                                    </table>
                                </div>


                                <!--历史修改视图-->
                                <div class="J_historyview Hide historyview">
                                    <div class="row">
                                        <div class="col-md-11 col-md-offset-1 list" style="">
                                            <div class="media">
                                                <img src="../../img/history.png"/>
                                                <div class="row">
                                                    <div class="col-md-10"><h5 class="media-heading">2016-02-23
                                                        12:23
                                                        王玉</h5>
                                                        <p>
                                                            修改comment
                                                        </p></div>
                                                    <div class="col-md-2 text-right">
                                                        <button class="btn btn-default" type="submit">查看修改内容
                                                        </button>
                                                    </div>
                                                </div>
                                                <hr>
                                            </div>
                                            <div class="media">
                                                <img src="../../img/history.png"/>
                                                <div class="row">
                                                    <div class="col-md-10"><h5 class="media-heading">2016-02-23
                                                        12:23
                                                        王玉</h5>
                                                        <p>
                                                            修改comment
                                                        </p></div>
                                                    <div class="col-md-2 text-right">
                                                        <button class="btn btn-default" type="submit">查看修改内容
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <!--commit-->
                            <div class="media J_commitchange Hide">
                                <div class="media-left">
                                    <a href="#">
                                        <img class="media-object" src="../../img/icon.jpg" style="height: 75px; width: 75px;">
                                    </a>
                                </div>
                                <div class="media-body">
                                    <h4 class="media-heading">Commit changes</h4>
                                    <textarea class="form-control" rows="4"></textarea>
                                    <br>
                                    <button class="btn btn-default" type="submit">submit</button>
                                    <button class="btn btn-default" type="submit">cancel</button>
                                </div>

                            </div>
                        </div>

                    </div>

                </div>

            </div>
        </div>

    </div>

<div ng-include="'../common/footer.html'"></div>

<!-- jquery.js -->
<script src="../../vendor/jquery.js" type="text/javascript"></script>

<!--lodash.js-->
<script src="../../vendor/lodash.min.js" type="text/javascript"></script>

<!--angular-->
<script src="../../vendor/angular/angular.min.js"></script>
<script src="../../vendor/angular/angular-ui-router.min.js"></script>
<script src="../../vendor/angular/angular-resource.min.js"></script>
<script src="../../vendor/angular/angular-toastr-1.4.1.tpls.min.js"></script>
<script src="../../vendor/angular/loading-bar.min.js"></script>
<script src="../../vendor/angular/ng-table.min.js"></script>

<!-- bootstrap.js -->
<script src="../../vendor/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../../vendor/bootstrap/js/bootstrap-treeview.min.js" type="text/javascript"></script>

<!--biz script-->
<script type="application/javascript" src="../../scripts/app.js"></script>

<!--directive-->

<!--service-->
<script type="application/javascript" src="../../scripts/services/AppService.js"></script>
<script type="application/javascript" src="../../scripts/services/EnvService.js"></script>
<script type="application/javascript" src="../../scripts/services/ConfigService.js"></script>
<script type="application/javascript" src="../../scripts/services/VersionService.js"></script>

<!--controller-->
<script type="application/javascript" src="../../scripts/controller/app/AppConfigController.js"></script>

</body>
</html>
